// Used for building a runnable jar
plugins {
    id 'java'
}

// Where the code is
sourceSets {
    main {
        java {
            srcDir 'src/'
        }
    }
}

// Where to find patched_client.jar
repositories {
    flatDir {
        dirs './'
    }
}

// The patched_client dependency
dependencies {
    implementation name: 'patched_client'
}

jar {
    // Starting class
    manifest {
        attributes 'Main-Class': 'bot.Main'
    }
    // Name of the .jar
    baseName = "IdleRSC"

    // Include all the source files
    from {
        configurations.compile.collect { it.isDirectory() ? it : zipTree(it) }
        configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) }
    }
}

// Moves the compiled jar at build/libs/IdleRSC.jar to the root folder
task copyJar(type: Copy) {
    from "./build/libs"
    into "./"
}

// Deletes the build directory
task cleanBuildDir(type: Delete) {
    delete 'build'
}

// cleanBuildJar depends on copyJar running first
cleanBuildDir.dependsOn(copyJar)

// "gradle build" depends on cleanBuildJar running first
build.dependsOn(cleanBuildDir)
